services:
  pmf-app:
    build: 
      context: .
      dockerfile: Dockerfile
    container_name: pmf-telemetry-analysis
    ports:
      - "8501:8501"
    
    volumes:
      - ./src:/app/src
      # in caso di nuova telemetria non c'Ã¨ bisogno di rifare immagine
      - ./data:/app/data 
    
    environment:
      - DATA_FILENAME=mugello_telemetry_2020_f1_LEC.parquet
      - REV_LIMIT_RPM=14000
      - MIN_BRAKE_SPEED=80
      - GEAR_OFFSET=-2
      
      - STREAMLIT_SERVER_ADDRESS=0.0.0.0
      - STREAMLIT_SERVER_PORT=8501
      # evita che Streamlit chieda la mail all'avvio
      - STREAMLIT_BROWSER_GATHER_USAGE_STATS=false

    # riavvia sempre se il container crasha
    restart: always